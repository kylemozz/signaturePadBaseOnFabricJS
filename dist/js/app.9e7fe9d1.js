(function(t){function e(e){for(var i,o,r=e[0],c=e[1],l=e[2],d=0,h=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},s={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0717":function(t,e,n){},1:function(t,e){},2:function(t,e){},3:function(t,e){},"3bd5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],o=(n("034f"),n("2877")),r={},c=Object(o["a"])(r,s,a,!1,null,null,null),l=c.exports,u=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal"}},[n("el-menu-item",{staticClass:"menu-item",attrs:{index:"1"}},[n("el-button",{attrs:{disabled:""},on:{click:t.switchMode}},[t._v(t._s(t.Mode))])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"1"}},[n("el-button",{on:{click:t.download}},[t._v("保存")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"2"}},[t._v(" 格式： "),n("el-select",{staticClass:"selectModule",attrs:{placeholder:"请选择"},model:{value:t.imageType,callback:function(e){t.imageType=e},expression:"imageType"}},t._l(t.options,(function(t){return n("el-option",{key:t.vlaue,attrs:{label:t.label,value:t.value}})})),1)],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"3"}},[n("el-button",{on:{click:t.clear}},[t._v("清除")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"8"},on:{click:t.imageInput}},[n("el-button",[t._v("导入图片")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"6"}},[n("el-button",{on:{click:t.saveTraceAsJSON}},[t._v("导出轨迹")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"7"}},[n("el-button",{on:{click:t.jsonInput}},[t._v("导入轨迹")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"15"}},[n("el-button",{on:{click:t.traceForward}},[t._v("前进")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"9"}},[n("el-button",{on:{click:t.traceBackward}},[t._v("撤回")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"10"}},[n("el-button",{on:{click:t.eraserTrigger}},[t._v("橡皮擦")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"11"}},[n("el-button",{on:{click:t.penShape}},[t._v("笔锋")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"12"}},[n("el-button",{on:{click:t.scaleUp}},[t._v("放大")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"13"}},[n("el-button",{on:{click:t.scaleDown}},[t._v("缩小")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"14"}},[n("el-button",{on:{click:t.showLineWidthDialog}},[t._v("粗细")])],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"15"}},[n("span",[t._v("颜色：")]),n("el-color-picker",{on:{change:t.colorChange},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1),n("el-menu-item",{staticClass:"menu-item",attrs:{index:"16"}},[n("span",[t._v("放大倍数"+t._s(t.magnifi))])])],1),n("fabric-canvas",{ref:"sig",attrs:{lineWidth:t.lineWidth,lineColor:t.color}}),n("el-dialog",{attrs:{title:"粗细",visible:t.lineWidthDialogVisible},on:{"update:visible":function(e){t.lineWidthDialogVisible=e}}},[n("el-slider",{on:{change:t.lineWidthChange},model:{value:t.lineWidth,callback:function(e){t.lineWidth=e},expression:"lineWidth"}})],1)],1)},h=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"canvasContainer",staticClass:"canvasContainer"},[n("canvas",{ref:"canvas",attrs:{id:"origin-canvas"}}),n("input",{ref:"imageInputBtn",staticStyle:{display:"none"},attrs:{id:"imageInputBtn",type:"file"},on:{change:function(e){return t.imageAdd(e)}}}),n("input",{ref:"jsonInputBtn",staticStyle:{display:"none"},attrs:{id:"jsonInputBtn",type:"file"},on:{change:function(e){return t.jsonAdd(e)}}})])},m=[],v=(n("a9e3"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("7a94")),g={name:"Home",components:{},props:{lineWidth:{type:Number,default:1},lineColor:{type:String,default:"#000000"}},data:function(){return{canvas:"",historyLock:!1,undoHistory:[],redoHistroy:[]}},mounted:function(){this.canvasPorpertyInit(),window.addEventListener("resize",(function(){})),window.addEventListener("orientationchange",function(){var t=this;setTimeout((function(){t.canvasWidthHeightInit()}),200)}.bind(this)),this.canvas.on("selection:created",function(t){if(this.historyLock=!0,t.target._objects){for(var e=t.target._objects.length,n=0;n<e;n++)this.canvas.remove(t.target._objects[n]);this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1}else this.canvas.remove(t.target),this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1;this.canvas.discardActiveObject()}.bind(this)),this.undoHistory.push(JSON.stringify(this.canvas)),this.canvas.on("object:added",function(){this.historyLock||(this.undoHistory.push(JSON.stringify(this.canvas)),this.redoHistroy.length=0)}.bind(this)),this.canvas.on("object:modified",function(){this.historyLock||(this.undoHistory.push(JSON.stringify(this.canvas)),this.redoHistroy.length=0)}.bind(this))},methods:{saveTraceAsJSON:function(){var t=JSON.stringify(this.canvas),e=new Blob([t]),n=document.createElement("a");n.download="签名.json",n.href=URL.createObjectURL(e),n.click()},undo:function(){if(this.undoHistory.length>0){this.historyLock=!0,this.undoHistory.length>1&&this.redoHistroy.push(this.undoHistory.pop());var t=this.undoHistory[this.undoHistory.length-1];this.canvas.loadFromJSON(t,function(){this.canvas.renderAll(),this.historyLock=!1}.bind(this))}},redo:function(){if(this.redoHistroy.length>0){this.historyLock=!0;var t=this.redoHistroy.pop();this.undoHistory.push(t),this.canvas.loadFromJSON(t,function(){this.canvas.renderAll(),this.historyLock=!1}.bind(this))}},canvasPorpertyInit:function(){var t=this.$refs.canvas;this.canvas=new v["fabric"].Canvas(t,{isDrawingMode:!0}),this.canvasWidthHeightInit()},canvasWidthHeightInit:function(){var t=this.$refs.canvasContainer,e=t.clientHeight,n=t.clientWidth;this.canvas.setDimensions({width:n,height:e})},switchMode:function(t){this.canvas.isDrawingMode=t},canvasClear:function(){this.historyLock=!0,this.canvas.clear(),this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1},download:function(t){if("svg"===t){var e=this.canvas.toSVG(),n=document.createElement("a"),i=new Blob([e],{type:"image/svg+xml"}),s=URL.createObjectURL(i);n.href=s,n.download="signature.svg",n.click()}else{var a=t,o=this.canvas.toDataURL({format:a,enableRetinaScaling:!0}),r=document.createElement("a");r.href=o,r.download="signature.".concat(a),r.click()}},imageInput:function(){this.$refs.imageInputBtn.click()},jsonInput:function(){this.$refs.jsonInputBtn.click()},imageAdd:function(t){var e=this,n=t.target.files[0].type,i=URL.createObjectURL(t.target.files[0]);console.log(e.canvas),"image/png"===n||"image/jpeg"===n?v["fabric"].Image.fromURL(i,(function(t){e.canvas.add(t)})):"image/svg+xml"===n?v["fabric"].loadSVGFromURL(i,(function(t,n){var i=v["fabric"].util.groupSVGElements(t,n);e.canvas.add(i)})):alert("不支持此类型文件")},jsonAdd:function(t){var e=this,n=t.target.files[0],i=t.target.files[0].type;if("application/json"===i){var s="",a=new FileReader;a.onload=function(t){s=t.target.result,e.canvas.loadFromJSON(s,(function(){e.canvas.renderAll()}))},a.readAsText(n)}else alert("不支持此类型文件")},setLineWidth:function(){this.canvas.freeDrawingBrush.width=this.lineWidth},setLineColor:function(){this.canvas.freeDrawingBrush.color=this.lineColor}}},p=g,b=(n("9ac9"),Object(o["a"])(p,f,m,!1,null,"2730658d",null)),y=b.exports,w={name:"Home",components:{fabricCanvas:y},data:function(){return{options:[{value:"jpg",label:"jpg"},{value:"png",label:"png"},{value:"svg",label:"svg"}],drawingMode:!0,imageType:"jpg",lineWidthDialogVisible:!1,lineWidth:5,color:"#000000"}},computed:{Mode:function(){return this.drawingMode?"书写模式":"选择模式"}},methods:{switchMode:function(){this.drawingMode=!this.drawingMode,this.$refs.sig.switchMode(this.drawingMode)},clear:function(){this.$refs.sig.canvasClear()},download:function(){this.$refs.sig.download(this.imageType)},imageInput:function(){this.$refs.sig.imageInput()},traceForward:function(){this.$refs.sig.redo()},traceBackward:function(){this.$refs.sig.undo()},saveTraceAsJSON:function(){this.$refs.sig.saveTraceAsJSON()},jsonInput:function(){this.$refs.sig.jsonInput()},eraserTrigger:function(){this.drawingMode=!this.drawingMode,this.$refs.sig.switchMode(this.drawingMode)},showLineWidthDialog:function(){this.lineWidthDialogVisible=!0},lineWidthChange:function(){this.$refs.sig.setLineWidth()},colorChange:function(){console.log(this.color),this.$nextTick((function(){this.$refs.sig.setLineColor()}))}}},k=w,j=(n("a60d"),Object(o["a"])(k,d,h,!1,null,"ecf7192c",null)),C=j.exports;i["default"].use(u["a"]);var _=[{path:"/",name:"Home",component:C}],x=new u["a"]({routes:_}),O=x,L=n("2f62");i["default"].use(L["a"]);var S=new L["a"].Store({state:{},mutations:{},actions:{},modules:{}}),H=n("5c96"),M=n.n(H);n("0fae");i["default"].config.productionTip=!1,i["default"].use(M.a),new i["default"]({router:O,store:S,render:function(t){return t(l)}}).$mount("#app")},"85ec":function(t,e,n){},"9ac9":function(t,e,n){"use strict";n("3bd5")},a60d:function(t,e,n){"use strict";n("0717")}});
//# sourceMappingURL=app.9e7fe9d1.js.map