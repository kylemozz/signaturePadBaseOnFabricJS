(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],h=0,d=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(d.length)d.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==s[c]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},a=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},a=[],o=(i("034f"),i("2877")),r={},c=Object(o["a"])(r,s,a,!1,null,null,null),l=c.exports,u=i("8c4f"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal"}},[i("el-menu-item",{staticClass:"menu-item",attrs:{index:"1"}},[i("el-button",{attrs:{disabled:""},on:{click:t.switchMode}},[t._v(t._s(t.Mode))])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"1"}},[i("el-button",{on:{click:t.download}},[t._v("保存")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"2"}},[t._v(" 格式： "),i("el-select",{staticClass:"selectModule",attrs:{placeholder:"请选择"},model:{value:t.imageType,callback:function(e){t.imageType=e},expression:"imageType"}},t._l(t.options,(function(t){return i("el-option",{key:t.vlaue,attrs:{label:t.label,value:t.value}})})),1)],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"3"}},[i("el-button",{on:{click:t.clear}},[t._v("清除")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"8"},on:{click:t.imageInput}},[i("el-button",[t._v("导入图片")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"6"}},[i("el-button",{on:{click:t.saveTraceAsJSON}},[t._v("导出轨迹")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"7"}},[i("el-button",{on:{click:t.jsonInput}},[t._v("导入轨迹")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"15"}},[i("el-button",{on:{click:t.traceForward}},[t._v("前进")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"9"}},[i("el-button",{on:{click:t.traceBackward}},[t._v("撤回")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"10"}},[i("el-button",{on:{click:t.eraserTrigger}},[t._v("橡皮擦")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"11"}},[i("el-button",{on:{click:t.setPenShape}},[t._v("笔锋")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"14"}},[i("el-button",{on:{click:t.showLineWidthDialog}},[t._v("粗细")])],1),i("el-menu-item",{staticClass:"menu-item",attrs:{index:"15"}},[i("span",[t._v("颜色：")]),i("el-color-picker",{on:{change:t.colorChange},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)],1),i("fabric-canvas",{ref:"sig",attrs:{lineWidth:t.lineWidth,lineColor:t.color}}),i("el-dialog",{attrs:{title:"粗细",visible:t.lineWidthDialogVisible},on:{"update:visible":function(e){t.lineWidthDialogVisible=e}}},[i("el-slider",{on:{change:t.lineWidthChange},model:{value:t.lineWidth,callback:function(e){t.lineWidth=e},expression:"lineWidth"}})],1)],1)},d=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"canvasContainer",staticClass:"canvasContainer"},[i("canvas",{ref:"canvas",attrs:{id:"origin-canvas"}}),i("input",{ref:"imageInputBtn",staticStyle:{display:"none"},attrs:{id:"imageInputBtn",type:"file"},on:{change:function(e){return t.imageAdd(e)}}}),i("input",{ref:"jsonInputBtn",staticStyle:{display:"none"},attrs:{id:"jsonInputBtn",type:"file"},on:{change:function(e){return t.jsonAdd(e)}}})])},p=[],v=(i("a9e3"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("7a94")),g={name:"Home",components:{},props:{lineWidth:{type:Number,default:1},lineColor:{type:String,default:"#000000"}},data:function(){return{canvas:"",historyLock:!1,undoHistory:[],redoHistroy:[],vLinePatternBrush:""}},mounted:function(){this.canvasPorpertyInit(),this.createBrush(),window.addEventListener("resize",(function(){})),window.addEventListener("orientationchange",function(){var t=this;setTimeout((function(){t.canvasWidthHeightInit()}),200)}.bind(this)),this.canvas.on("selection:created",function(t){if(this.historyLock=!0,t.target._objects){for(var e=t.target._objects.length,i=0;i<e;i++)this.canvas.remove(t.target._objects[i]);this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1}else this.canvas.remove(t.target),this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1;this.canvas.discardActiveObject()}.bind(this)),this.undoHistory.push(JSON.stringify(this.canvas)),this.canvas.on("object:added",function(){this.historyLock||(this.undoHistory.push(JSON.stringify(this.canvas)),this.redoHistroy.length=0)}.bind(this)),this.canvas.on("object:modified",function(){this.historyLock||(this.undoHistory.push(JSON.stringify(this.canvas)),this.redoHistroy.length=0)}.bind(this))},methods:{createBrush:function(){v["fabric"].MarkerBrush=v["fabric"].util.createClass(v["fabric"].BaseBrush,{color:"#000",opacity:1,width:30,_baseWidth:10,_lastPoint:null,_lineWidth:3,_point:null,_size:0,initialize:function(t,e){e=e||{},this.canvas=t,this.width=e.width||t.freeDrawingBrush.width,this.color=e.color||t.freeDrawingBrush.color,this.opacity=e.opacity||t.contextTop.globalAlpha,this.canvas.contextTop.globalAlpha=this.opacity,this._point=new v["fabric"].Point,this.canvas.contextTop.lineJoin="round",this.canvas.contextTop.lineCap="round"},_render:function(t){var e,i;e=this.canvas.contextTop,e.beginPath();for(var n=0,s=this._size/this._lineWidth/2;n<s;n++)i=(this._lineWidth-1)*n,e.globalAlpha=.8*this.opacity,e.moveTo(this._lastPoint.x+i,this._lastPoint.y+i),e.lineTo(t.x+i,t.y+i),e.stroke();this._lastPoint=new v["fabric"].Point(t.x,t.y)},onMouseDown:function(t){this._lastPoint=t,this.canvas.contextTop.strokeStyle=this.color,this.canvas.contextTop.lineWidth=this._lineWidth,this._size=this.width+this._baseWidth},onMouseMove:function(t){this.canvas._isCurrentlyDrawing&&this._render(t)},onMouseUp:function(){this.canvas.contextTop.globalAlpha=this.opacity,this.canvas.contextTop.globalAlpha=1}})},saveTraceAsJSON:function(){var t=JSON.stringify(this.canvas),e=new Blob([t]),i=document.createElement("a");i.download="签名.json",i.href=URL.createObjectURL(e),i.click()},undo:function(){if(this.undoHistory.length>0){this.historyLock=!0,this.undoHistory.length>1&&this.redoHistroy.push(this.undoHistory.pop());var t=this.undoHistory[this.undoHistory.length-1];this.canvas.loadFromJSON(t,function(){this.canvas.renderAll(),this.historyLock=!1}.bind(this))}},redo:function(){if(this.redoHistroy.length>0){this.historyLock=!0;var t=this.redoHistroy.pop();this.undoHistory.push(t),this.canvas.loadFromJSON(t,function(){this.canvas.renderAll(),this.historyLock=!1}.bind(this))}},canvasPorpertyInit:function(){var t=this.$refs.canvas;this.canvas=new v["fabric"].Canvas(t,{isDrawingMode:!0}),this.canvasWidthHeightInit()},canvasWidthHeightInit:function(){var t=this.$refs.canvasContainer,e=t.clientHeight,i=t.clientWidth;this.canvas.setDimensions({width:i,height:e})},switchMode:function(t){this.canvas.isDrawingMode=t},canvasClear:function(){this.historyLock=!0,this.canvas.clear(),this.undoHistory.push(JSON.stringify(this.canvas)),this.historyLock=!1},download:function(t){if("svg"===t){var e=this.canvas.toSVG(),i=document.createElement("a"),n=new Blob([e],{type:"image/svg+xml"}),s=URL.createObjectURL(n);i.href=s,i.download="signature.svg",i.click()}else{var a=t,o=this.canvas.toDataURL({format:a,enableRetinaScaling:!0}),r=document.createElement("a");r.href=o,r.download="signature.".concat(a),r.click()}},imageInput:function(){this.$refs.imageInputBtn.click()},jsonInput:function(){this.$refs.jsonInputBtn.click()},imageAdd:function(t){var e=this,i=t.target.files[0].type,n=URL.createObjectURL(t.target.files[0]);console.log(e.canvas),"image/png"===i||"image/jpeg"===i?v["fabric"].Image.fromURL(n,(function(t){e.canvas.add(t)})):"image/svg+xml"===i?v["fabric"].loadSVGFromURL(n,(function(t,i){var n=v["fabric"].util.groupSVGElements(t,i);e.canvas.add(n)})):alert("不支持此类型文件")},jsonAdd:function(t){var e=this,i=t.target.files[0],n=t.target.files[0].type;if("application/json"===n){var s="",a=new FileReader;a.onload=function(t){s=t.target.result,e.canvas.loadFromJSON(s,(function(){e.canvas.renderAll()}))},a.readAsText(i)}else alert("不支持此类型文件")},setLineWidth:function(){this.canvas.freeDrawingBrush.width=this.lineWidth},setLineColor:function(){this.canvas.freeDrawingBrush.color=this.lineColor;var t=this.canvas.freeDrawingBrush;t.getPatternSrc&&(t.source=t.getPatternSrc())},setPenShape:function(){this.canvas.freeDrawingBrush=new v["fabric"].MarkerBrush(this.canvas,{})}}},m=g,b=(i("aa5c"),Object(o["a"])(m,f,p,!1,null,"e61a45ae",null)),y=b.exports,w={name:"Home",components:{fabricCanvas:y},data:function(){return{options:[{value:"jpg",label:"jpg"},{value:"png",label:"png"},{value:"svg",label:"svg"}],drawingMode:!0,imageType:"jpg",lineWidthDialogVisible:!1,lineWidth:5,color:"#000000"}},computed:{Mode:function(){return this.drawingMode?"书写模式":"选择模式"}},methods:{switchMode:function(){this.drawingMode=!this.drawingMode,this.$refs.sig.switchMode(this.drawingMode)},clear:function(){this.$refs.sig.canvasClear()},download:function(){this.$refs.sig.download(this.imageType)},imageInput:function(){this.$refs.sig.imageInput()},traceForward:function(){this.$refs.sig.redo()},traceBackward:function(){this.$refs.sig.undo()},saveTraceAsJSON:function(){this.$refs.sig.saveTraceAsJSON()},jsonInput:function(){this.$refs.sig.jsonInput()},eraserTrigger:function(){this.drawingMode=!this.drawingMode,this.$refs.sig.switchMode(this.drawingMode)},showLineWidthDialog:function(){this.lineWidthDialogVisible=!0},lineWidthChange:function(){this.$refs.sig.setLineWidth()},colorChange:function(){console.log(this.color),this.$nextTick((function(){this.$refs.sig.setLineColor()}))},setPenShape:function(){this.$refs.sig.setPenShape()}}},_=w,k=(i("a68b"),Object(o["a"])(_,h,d,!1,null,"1e6b6168",null)),x=k.exports;n["default"].use(u["a"]);var j=[{path:"/",name:"Home",component:x}],C=new u["a"]({routes:j}),S=C,O=i("2f62");n["default"].use(O["a"]);var L=new O["a"].Store({state:{},mutations:{},actions:{},modules:{}}),W=i("5c96"),M=i.n(W);i("0fae");n["default"].config.productionTip=!1,n["default"].use(M.a),new n["default"]({router:S,store:L,render:function(t){return t(l)}}).$mount("#app")},"85ec":function(t,e,i){},a68b:function(t,e,i){"use strict";i("fba8")},aa5c:function(t,e,i){"use strict";i("be73")},be73:function(t,e,i){},fba8:function(t,e,i){}});
//# sourceMappingURL=app.4fac5bda.js.map